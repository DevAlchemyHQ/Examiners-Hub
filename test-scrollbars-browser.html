<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrollbar Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        iframe { width: 100%; height: 600px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>üß™ Scrollbar Test Dashboard</h1>
    
    <div class="test-section">
        <h2>üì± App Status</h2>
        <div id="app-status" class="result info">Checking app status...</div>
        <button onclick="checkAppStatus()">Check App Status</button>
        <button onclick="openApp()">Open App in New Tab</button>
    </div>
    
    <div class="test-section">
        <h2>üîç Scrollbar Detection</h2>
        <div id="scrollbar-results" class="result info">Click "Test Scrollbars" to check...</div>
        <button onclick="testScrollbars()">Test Scrollbars</button>
        <button onclick="inspectElements()">Inspect Elements</button>
    </div>
    
    <div class="test-section">
        <h2>üìä Content Analysis</h2>
        <div id="content-results" class="result info">Click "Analyze Content" to check...</div>
        <button onclick="analyzeContent()">Analyze Content</button>
    </div>
    
    <div class="test-section">
        <h2>üéØ Live App View</h2>
        <iframe id="app-frame" src="http://localhost:5173"></iframe>
    </div>

    <script>
        async function checkAppStatus() {
            const statusDiv = document.getElementById('app-status');
            statusDiv.className = 'result info';
            statusDiv.textContent = 'Checking app status...';
            
            try {
                const response = await fetch('http://localhost:5173');
                if (response.ok) {
                    statusDiv.className = 'result success';
                    statusDiv.textContent = '‚úÖ App is running on localhost:5173';
                } else {
                    statusDiv.className = 'result error';
                    statusDiv.textContent = '‚ùå App responded with status: ' + response.status;
                }
            } catch (error) {
                statusDiv.className = 'result error';
                statusDiv.textContent = '‚ùå Cannot connect to app: ' + error.message;
            }
        }
        
        function openApp() {
            window.open('http://localhost:5173', '_blank');
        }
        
        async function testScrollbars() {
            const resultsDiv = document.getElementById('scrollbar-results');
            resultsDiv.className = 'result info';
            resultsDiv.textContent = 'Testing scrollbars...';
            
            try {
                // Try to access the app iframe
                const iframe = document.getElementById('app-frame');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                const containers = iframeDoc.querySelectorAll('.overflow-y-auto');
                const results = [];
                
                containers.forEach((container, index) => {
                    const computedStyle = window.getComputedStyle(container);
                    const hasOverflowY = computedStyle.overflowY === 'auto' || computedStyle.overflowY === 'scroll';
                    const scrollHeight = container.scrollHeight;
                    const clientHeight = container.clientHeight;
                    const hasScrollableContent = scrollHeight > clientHeight;
                    
                    results.push({
                        index,
                        className: container.className,
                        hasScrollbar: hasOverflowY,
                        hasScrollableContent,
                        scrollHeight,
                        clientHeight,
                        overflowY: computedStyle.overflowY,
                        tagName: container.tagName
                    });
                });
                
                const summary = {
                    totalContainers: results.length,
                    containersWithScrollbars: results.filter(r => r.hasScrollbar).length,
                    containersWithContent: results.filter(r => r.hasScrollableContent).length
                };
                
                resultsDiv.className = 'result success';
                resultsDiv.innerHTML = `
                    <h3>‚úÖ Scrollbar Test Results:</h3>
                    <p><strong>Total containers:</strong> ${summary.totalContainers}</p>
                    <p><strong>With scrollbars:</strong> ${summary.containersWithScrollbars}</p>
                    <p><strong>With scrollable content:</strong> ${summary.containersWithContent}</p>
                    <pre>${JSON.stringify(results, null, 2)}</pre>
                `;
                
            } catch (error) {
                resultsDiv.className = 'result error';
                resultsDiv.textContent = '‚ùå Error testing scrollbars: ' + error.message;
            }
        }
        
        function inspectElements() {
            const iframe = document.getElementById('app-frame');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const allElements = iframeDoc.querySelectorAll('*');
            const overflowElements = Array.from(allElements).filter(el => {
                const style = window.getComputedStyle(el);
                return style.overflowY === 'auto' || style.overflowY === 'scroll';
            });
            
            const resultsDiv = document.getElementById('scrollbar-results');
            resultsDiv.className = 'result info';
            resultsDiv.innerHTML = `
                <h3>üîç Element Inspection:</h3>
                <p><strong>Total elements:</strong> ${allElements.length}</p>
                <p><strong>Elements with overflow-y:</strong> ${overflowElements.length}</p>
                <pre>${overflowElements.map(el => `${el.tagName}.${el.className} - overflow-y: ${window.getComputedStyle(el).overflowY}`).join('\n')}</pre>
            `;
        }
        
        async function analyzeContent() {
            const resultsDiv = document.getElementById('content-results');
            resultsDiv.className = 'result info';
            resultsDiv.textContent = 'Analyzing content...';
            
            try {
                const iframe = document.getElementById('app-frame');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                const images = iframeDoc.querySelectorAll('img');
                const divs = iframeDoc.querySelectorAll('div');
                const containers = iframeDoc.querySelectorAll('.overflow-y-auto');
                
                const analysis = {
                    totalImages: images.length,
                    totalDivs: divs.length,
                    totalOverflowContainers: containers.length,
                    containerDetails: Array.from(containers).map((container, index) => ({
                        index,
                        className: container.className,
                        scrollHeight: container.scrollHeight,
                        clientHeight: container.clientHeight,
                        hasOverflow: container.scrollHeight > container.clientHeight,
                        childElements: container.children.length
                    }))
                };
                
                resultsDiv.className = 'result success';
                resultsDiv.innerHTML = `
                    <h3>üìä Content Analysis:</h3>
                    <p><strong>Total images:</strong> ${analysis.totalImages}</p>
                    <p><strong>Total divs:</strong> ${analysis.totalDivs}</p>
                    <p><strong>Overflow containers:</strong> ${analysis.totalOverflowContainers}</p>
                    <pre>${JSON.stringify(analysis.containerDetails, null, 2)}</pre>
                `;
                
            } catch (error) {
                resultsDiv.className = 'result error';
                resultsDiv.textContent = '‚ùå Error analyzing content: ' + error.message;
            }
        }
        
        // Auto-check app status on load
        window.onload = function() {
            checkAppStatus();
        };
    </script>
</body>
</html>
